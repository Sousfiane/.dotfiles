##### ─────────────────────────────────────────────────────────────
#####  TPM PLUGINS
##### ─────────────────────────────────────────────────────────────

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'Sousfiane/tmux'

set -g @rose_pine_variant 'main'
set -g @rose_pine_directory 'on' 
set -g @rose_pine_disable_active_window_menu 'on'
set -g @rose_pine_default_window_behavior 'on'

set -g @rose_pine_show_current_program 'on'

set -g @rose_pine_window_status_separator " "

##### ─────────────────────────────────────────────────────────────
#####  TERMINAL SETTINGS
##### ─────────────────────────────────────────────────────────────

set -g default-terminal "$TERM"

# Truecolor support
set -ga terminal-overrides ",xterm-256color:Tc"

# Undercurl / underline color support
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'

set -g mouse on

##### ─────────────────────────────────────────────────────────────
#####  PREFIX + NAVIGATION
##### ─────────────────────────────────────────────────────────────

# Change prefix to Ctrl+Space
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Window & pane indexing starts at 1
set -g base-index 1
set -g pane-base-index 1
set-w -g pane-base-index 1
set -g renumber-windows on
set -g detach-on-destroy off


##### ─────────────────────────────────────────────────────────────
#####  PANE MOVEMENT
##### ─────────────────────────────────────────────────────────────

bind -n M-Left  select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up    select-pane -U
bind -n M-Down  select-pane -D


##### ─────────────────────────────────────────────────────────────
#####  WINDOW MOVEMENT
##### ─────────────────────────────────────────────────────────────

bind -n M-n next-window
bind -n M-p previous-window


##### ─────────────────────────────────────────────────────────────
#####  AZERTY ALT+Number (window selection)
#####  Physical top row keys: & é " ' ( § è ! ç à
##### ─────────────────────────────────────────────────────────────

bind-key -n M-& select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-\" select-window -t 3
bind-key -n M-\' select-window -t 4
bind-key -n M-( select-window -t 5
bind-key -n M-§ select-window -t 6
bind-key -n M-è select-window -t 7
bind-key -n M-! select-window -t 8
bind-key -n M-ç select-window -t 9
bind-key -n M-à select-window -t 0

##### ─────────────────────────────────────────────────────────────
#####  SPLITS FOLLOW CURRENT DIR
##### ─────────────────────────────────────────────────────────────

bind '"' split-window -v -c "#{pane_current_path}"
bind %   split-window -h -c "#{pane_current_path}"


##### ─────────────────────────────────────────────────────────────
#####  COPY-MODE & SELECTION (VI)
##### ─────────────────────────────────────────────────────────────

set -g mode-keys vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "xsel -i --clipboard"


##### ─────────────────────────────────────────────────────────────
#####  TPM INIT (recommended)
##### ─────────────────────────────────────────────────────────────

# TPM bootstrap (safe, correct version)
if-shell "[ ! -d ~/.tmux/plugins/tpm ]" \
    "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins'" \
    ""

run '~/.tmux/plugins/tpm/tpm'

